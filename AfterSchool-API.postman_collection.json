{
  "info": {
    "_postman_id": "afterschool-api-v1",
    "name": "AfterSchool API",
    "description": "API for after-school lessons: browse, search, reserve, and manage orders. Includes health/docs, lessons, search, orders, and image endpoints.",
    "schema": "https://schema.getpostman.com/json/collection/v2.1.0/collection.json"
  },
  "item": [
    {
      "name": "Health / Docs",
      "request": {
        "method": "GET",
        "header": [],
        "url": {
          "raw": "{{baseUrl}}/",
          "host": ["{{baseUrl}}"],
          "path": [""]
        },
        "description": "API documentation and health status with uptime."
      },
      "response": []
    },
    {
      "name": "Get all lessons",
      "request": {
        "method": "GET",
        "header": [],
        "url": {
          "raw": "{{baseUrl}}/lessons",
          "host": ["{{baseUrl}}"],
          "path": ["lessons"]
        },
        "description": "Fetch all lessons. Each lesson includes id, subject, location, price, spaces, description, image, and addedAt."
      },
      "response": []
    },
    {
      "name": "Search lessons",
      "request": {
        "method": "GET",
        "header": [],
        "url": {
          "raw": "{{baseUrl}}/search?q={{searchQuery}}",
          "host": ["{{baseUrl}}"],
          "path": ["search"],
          "query": [
            {
              "key": "q",
              "value": "{{searchQuery}}",
              "description": "Search term (matches subject, location, description; also numeric price/spaces)."
            }
          ]
        },
        "description": "Search lessons by query. Case-insensitive."
      },
      "response": []
    },
    {
      "name": "Create order",
      "request": {
        "method": "POST",
        "header": [
          {
            "key": "Content-Type",
            "value": "application/json"
          }
        ],
        "body": {
          "mode": "raw",
          "raw": "{\n  \"name\": \"Avery Daniels\",\n  \"phone\": \"5551234\",\n  \"email\": \"avery@example.com\",\n  \"items\": [\n    { \"lessonId\": \"{{lessonId}}\", \"spaces\": 2 }\n  ]\n}"
        },
        "url": {
          "raw": "{{baseUrl}}/orders",
          "host": ["{{baseUrl}}"],
          "path": ["orders"]
        },
        "description": "Create a new order/reservation. Returns created order with id."
      },
      "response": []
    },
    {
      "name": "Get all orders",
      "request": {
        "method": "GET",
        "header": [],
        "url": {
          "raw": "{{baseUrl}}/orders",
          "host": ["{{baseUrl}}"],
          "path": ["orders"]
        },
        "description": "Fetch all orders (admin/export). Includes id, name, phone, email, items, and createdAt."
      },
      "response": []
    },
    {
      "name": "Update lesson spaces",
      "request": {
        "method": "PUT",
        "header": [
          {
            "key": "Content-Type",
            "value": "application/json"
          }
        ],
        "body": {
          "mode": "raw",
          "raw": "{\n  \"spaces\": {{newSpaces}}\n}"
        },
        "url": {
          "raw": "{{baseUrl}}/lessons/{{lessonId}}",
          "host": ["{{baseUrl}}"],
          "path": ["lessons", "{{lessonId}}"]
        },
        "description": "Update a lesson (commonly used to decrement spaces after an order). Returns updated lesson."
      },
      "response": []
    },
    {
      "name": "Get lesson image",
      "request": {
        "method": "GET",
        "header": [],
        "url": {
          "raw": "{{baseUrl}}/images/{{imageFileName}}",
          "host": ["{{baseUrl}}"],
          "path": ["images", "{{imageFileName}}"]
        },
        "description": "Serve static lesson images by filename. Returns 404 if not found."
      },
      "response": []
    }
  ],
  "event": [
    {
      "listen": "prerequest",
      "script": {
        "type": "text/javascript",
        "exec": [
          "// Example: set a random lessonId if not set (for demo)",
          "if (!pm.collectionVariables.get('lessonId')) {",
          "  pm.collectionVariables.set('lessonId', '65a1b2c3d4e5f67890abcdef');",
          "}"
        ]
      }
    },
    {
      "listen": "test",
      "script": {
        "type": "text/javascript",
        "exec": [
          "// Simple tests",
          "if (pm.response.code >= 200 && pm.response.code < 300) {",
          "  pm.test('Status code is success', () => {",
          "    pm.expect(pm.response.code).to.be.oneOf([200, 201]);",
          "  });",
          "} else {",
          "  pm.test('Status indicates error', () => {",
          "    pm.expect(pm.response.code).to.be.oneOf([400, 404, 500]);",
          "  });",
          "}"
        ]
      }
    }
  ],
  "variable": [
    {
      "key": "baseUrl",
      "value": "http://localhost:3000",
      "type": "string",
      "description": "Update to your deployed backend URL (e.g., https://your-backend.onrender.com)"
    },
    {
      "key": "searchQuery",
      "value": "music",
      "type": "string",
      "description": "Example search term"
    },
    {
      "key": "lessonId",
      "value": "",
      "type": "string",
      "description": "MongoDB ObjectId string for a lesson (copy from GET /lessons response)"
    },
    {
      "key": "newSpaces",
      "value": "3",
      "type": "string",
      "description": "New spaces count for PUT /lessons/:id"
    },
    {
      "key": "imageFileName",
      "value": "example.jpg",
      "type": "string",
      "description": "Filename of an image in public/images/"
    }
  ]
}
